# ======================
# 目标架构与固件配置
# ======================
CONFIG_64BIT=y
CONFIG_X86_64=y
CONFIG_TARGET_x86=y
CONFIG_TARGET_x86_64=y
CONFIG_TARGET_x86_64_DEVICE_generic=y
CONFIG_TARGET_KERNEL_PARTSIZE=32
CONFIG_TARGET_ROOTFS_PARTSIZE=944
CONFIG_TARGET_IMAGES_GZIP=y
CONFIG_TARGET_ROOTFS_SQUASHFS=y
CONFIG_GRUB_EFI_IMAGES=y
CONFIG_GRUB_TIMEOUT=1

# ======================
# 编译工具链优化
# ======================
CONFIG_OPTIMIZE_FOR_PERFORMANCE=y
CONFIG_TOOLCHAINOPTS=y
CONFIG_GCC_USE_GRAPHITE=y
CONFIG_USE_LTO=y
CONFIG_KERNEL_LTO=y
CONFIG_OPTIMIZE_INLINING=y
CONFIG_TARGET_OPTIMIZATION="-O3 -march=x86-64-v2 -pipe -fno-semantic-interposition -fipa-pta"

# ======================
# 网络协议栈硬件卸载
# ======================
CONFIG_KERNEL_TCP_CONG_BBR=y
CONFIG_DEFAULT_TCP_CONG="bbr"

# ======================
# 硬件流量分类与QoS卸载
# ======================
CONFIG_NET_SCH_FQ=y
CONFIG_NET_SCH_FQ_CODEL=y
CONFIG_NET_SCH_CAKE=y
CONFIG_NF_FLOW_TABLE_HW=y

# ======================
# 内核模块配置 - Netfilter核心模块
# ======================
CONFIG_PACKAGE_kmod-nft-core=y
CONFIG_PACKAGE_kmod-nft-nat=y
CONFIG_PACKAGE_kmod-nft-netdev=y
CONFIG_PACKAGE_kmod-nft-offload=y
CONFIG_PACKAGE_kmod-nft-queue=y
CONFIG_PACKAGE_kmod-nft-socket=y
CONFIG_PACKAGE_kmod-nft-tproxy=y
CONFIG_PACKAGE_kmod-nft-synproxy=y
CONFIG_PACKAGE_kmod-nft-bridge=y
CONFIG_PACKAGE_kmod-nft-fib=y
CONFIG_PACKAGE_kmod-nft-xfrm=y
CONFIG_PACKAGE_kmod-nft-ct=y
CONFIG_PACKAGE_kmod-nft-compat=y
CONFIG_PACKAGE_kmod-nft-reject=y
CONFIG_PACKAGE_kmod-nft-osf=y
CONFIG_PACKAGE_kmod-nft-rt=y
CONFIG_PACKAGE_kmod-nft-connlimit=y
CONFIG_PACKAGE_kmod-nft-quota=y
CONFIG_PACKAGE_kmod-nft-limit=y
CONFIG_PACKAGE_kmod-nft-masq=y
CONFIG_PACKAGE_kmod-nft-redir=y
CONFIG_PACKAGE_kmod-nft-tunnel=y

# ======================
# NFTables 增强内核模块
# ======================
CONFIG_PACKAGE_kmod-nft-numgen=y
CONFIG_PACKAGE_kmod-nft-chain-nat=y
CONFIG_PACKAGE_kmod-nft-flow-offload=y
CONFIG_PACKAGE_kmod-nft-fullcone=y
CONFIG_PACKAGE_kmod-nft-nat6=y

# ======================
# 内核模块配置 - Connection Tracking
# ======================
CONFIG_PACKAGE_kmod-nf-conntrack=y
CONFIG_PACKAGE_kmod-nf-conntrack-netlink=y
CONFIG_PACKAGE_kmod-nf-conntrack6=y
CONFIG_PACKAGE_kmod-nf-conntrack-extra=y
CONFIG_PACKAGE_kmod-nf-nat=y
CONFIG_PACKAGE_kmod-nf-nat6=y
CONFIG_PACKAGE_kmod-nf-nat-extra=y
CONFIG_PACKAGE_kmod-nf-reject=y
CONFIG_PACKAGE_kmod-nf-reject6=y
CONFIG_PACKAGE_kmod-nf-flow=y
CONFIG_PACKAGE_kmod-nf-tproxy=y
CONFIG_PACKAGE_kmod-nf-socket=y

# ======================
# 内核模块配置 - 调度与QoS
# ======================
CONFIG_PACKAGE_kmod-sched=y
CONFIG_PACKAGE_kmod-sched-core=y
CONFIG_PACKAGE_kmod-sched-bpf=y
CONFIG_PACKAGE_kmod-sched-connmark=y
CONFIG_PACKAGE_kmod-sched-flower=y
CONFIG_PACKAGE_kmod-sched-cake=y
CONFIG_PACKAGE_kmod-ifb=y
CONFIG_PACKAGE_kmod-ppp=y
CONFIG_PACKAGE_kmod-pppoe=y
CONFIG_PACKAGE_kmod-pppox=y
CONFIG_PACKAGE_kmod-fs-squashfs=y
CONFIG_PACKAGE_kmod-ip6tables=y

# ======================
# 用户态工具包 - Netfilter管理工具
# ======================
CONFIG_PACKAGE_nftables-json=y
CONFIG_PACKAGE_ebtables=y
CONFIG_PACKAGE_ebtables-utils=y
CONFIG_PACKAGE_ipset=y
CONFIG_PACKAGE_conntrack=y

# ======================
# 用户态工具包 - 网络基础工具
# ======================
CONFIG_PACKAGE_ethtool=y
CONFIG_PACKAGE_iperf3=y
CONFIG_PACKAGE_ip-full=y
CONFIG_PACKAGE_ip-bridge=y
CONFIG_PACKAGE_libcurl=y

# ======================
# 用户态工具包 - Netfilter库依赖
# ======================
CONFIG_PACKAGE_libnetfilter-conntrack=y
CONFIG_PACKAGE_libnfnetlink=y
CONFIG_PACKAGE_libnftnl=y
CONFIG_PACKAGE_libmnl=y
CONFIG_PACKAGE_libipset=y
CONFIG_PACKAGE_ip6tables=y

# ======================
# 用户态工具包 - 系统工具
# ======================
CONFIG_PACKAGE_sed=y
CONFIG_PACKAGE_gawk=y
CONFIG_PACKAGE_grep=y
CONFIG_PACKAGE_coreutils-sort=y

# ======================
# LuCI应用模块 (网络优化版)
# ======================
CONFIG_PACKAGE_luci-app-arpbind=y
CONFIG_PACKAGE_luci-app-oaf=y
CONFIG_PACKAGE_luci-app-filemanager=y
CONFIG_PACKAGE_luci-app-irqbalance=y
CONFIG_PACKAGE_luci-app-firewall=y
CONFIG_PACKAGE_luci-app-sqm=y
CONFIG_PACKAGE_luci-app-adblock-fast=y